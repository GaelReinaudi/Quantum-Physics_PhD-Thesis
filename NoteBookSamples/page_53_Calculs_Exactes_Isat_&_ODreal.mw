<?xml version="1.0" encoding="UTF-8"?>
<Worksheet><Version major="6" minor="1"/><View-Properties><Hide name="Input"/><Zoom percentage="100"/></View-Properties><Styles><Layout alignment="left" bullet="none" linespacing="0.0" name="Heading 1" spaceabove="8.0" spacebelow="4.0"/><Layout alignment="left" bullet="none" firstindent="0.0" leftmargin="0.0" linebreak="space" linespacing="0.0" name="Normal" rightmargin="0.0" spaceabove="0.0" spacebelow="0.0"/><Layout alignment="centred" bullet="none" linespacing="0.5" name="Maple Output"/><Font background="[0,0,0]" bold="true" executable="true" family="Monospaced" foreground="[255,0,0]" name="Maple Input" opaque="false" size="12"/><Font background="[0,0,0]" bold="false" executable="false" family="Times New Roman" foreground="[0,0,0]" italic="false" name="Text" opaque="false" size="12" underline="false"/><Font background="[0,0,0]" bold="true" family="Serif" name="Heading 1" opaque="false" size="18"/><Font background="[0,0,0]" family="Times New Roman" foreground="[0,0,255]" name="2D Output" opaque="false" readonly="true" size="12"/></Styles><Section><Title><Text-field layout="Heading 1" style="Heading 1">2005_11_16  :                                         Extracting Isat, and using it to measure OD_real.</Text-field></Title><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">restart;</Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input"><Font italic="false" underline="false">simp:=proc(asimplifier)
if type(asimplifier</Font>, equation<Font italic="false" underline="false">) then map(simp,asimplifier);
else
simplify(sort(simplify(simplify(factor(expand(numer(asimplifier))),size),size))
/        sort(simplify(simplify(factor(expand(denom(asimplifier))),size),size)),size) ;
map(simplify,%,size);        fi;end:</Font></Text-field></Input></Group></Section><Group><Input><Text-field layout="Normal" style="Text">TheColumns in the Origin file: to put the expression in the <Font bold="true">"set column values"</Font>.</Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">ColonnesOPJ := [
T			=col(a),
delta			=col(b),
Delta[delta]		=col(c),
OD[real][low]		=col(b)[12],
Delta[OD[real][low]]	=col(c)[12],
E[pulse][ici]		=col(d),
E[pulse][ici][ref]	=col(d)[1],
E[pulse][ici][backgournd]=col(d)[12],
Delta[E[pulse][ici]]	=col(e),
Slope			=col(f)[12],
Delta[Slope]		=col(g)[12],
E[pulse][av][ref]	=col(f)[13],
Delta[E[pulse][av][ref]]=col(g)[13]
]:
Origin := proc(expr) global ColonnesOPJ;

subs(ColonnesOPJ, expr);
#simplify(%, size);
end:</Text-field></Input></Group><Group><Input><Text-field layout="Normal" style="Text">The real optical density is given by:</Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">OD_real := I[0]/I[sat]*(1-exp(-delta))+delta;;</Text-field></Input><Output><Text-field layout="Maple Output" style="2D Output"><Equation>NiM+SShPRF9yZWFsRzYiLCYqKCZeIyIiIjYjIiIhRiomRik2I0kkc2F0R0YlISIiLCZGKkYqLUkkZXhwRzYkSSpwcm90ZWN0ZWRHRjVJKF9zeXNsaWJHRiU2IywkSSZkZWx0YUdGJUYwRjBGKkYqRjlGKg==</Equation></Text-field></Output></Group><Section><Title><Text-field layout="Heading 1" style="Heading 1">Finding Isat</Text-field></Title><Group><Input><Text-field layout="Normal" style="Text">Isat is determined with clouds of low optical densities (1 or 1.5) by plotting (cf lab book p83):</Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">G0 := (1-exp(-delta))/(OD[real][low]-delta):
g(delta) = G0;
Origin(G0);</Text-field></Input><Output><Text-field layout="Maple Output" style="2D Output"><Equation>NiMvLUkiZ0c2IjYjSSZkZWx0YUdGJiomLCYiIiJGKy1JJGV4cEc2JEkqcHJvdGVjdGVkR0YvSShfc3lzbGliR0YmNiMsJEYoISIiRjNGKywmJiZJI09ER0YmNiNJJXJlYWxHRi42I0kkbG93R0YmRitGKEYzRjM=</Equation></Text-field><Text-field layout="Maple Output" style="2D Output"><Equation>NiMqJiwmIiIiRiUtSSRleHBHNiRJKnByb3RlY3RlZEdGKUkoX3N5c2xpYkc2IjYjLCQtSSRjb2xHRis2I0kiYkdGKyEiIkYyRiUsJiZGLjYjIiM3RiVGLkYyRjI=</Equation></Text-field></Output></Group><Group><Input><Text-field layout="Normal" style="Text">--&gt; We can determine Isat with the slope of the curve:</Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">g(delta) = I[sat]/I[0];
g(delta) = I[sat]*T/I[0][max]/T[min];
I[sat] = Slope * I[0][max] * T[min];
I[sat] = Slope * E[pulse][ici];</Text-field></Input><Output><Text-field layout="Maple Output" style="2D Output"><Equation>NiMvLUkiZ0c2IjYjSSZkZWx0YUdGJiomJl4jIiIiNiNJJHNhdEdGJkYsJkYrNiMiIiEhIiI=</Equation></Text-field><Text-field layout="Maple Output" style="2D Output"><Equation>NiMvLUkiZ0c2IjYjSSZkZWx0YUdGJioqJl4jIiIiNiNJJHNhdEdGJkYsSSJUR0YmRiwmJkYrNiMiIiE2I0kkbWF4R0kqcHJvdGVjdGVkR0Y2ISIiJkYvNiNJJG1pbkdGNkY3</Equation></Text-field><Text-field layout="Maple Output" style="2D Output"><Equation>NiMvJl4jIiIiNiNJJHNhdEc2IiooSSZTbG9wZUdGKUYmJiZGJTYjIiIhNiNJJG1heEdJKnByb3RlY3RlZEdGMkYmJkkiVEdGKTYjSSRtaW5HRjJGJg==</Equation></Text-field><Text-field layout="Maple Output" style="2D Output"><Equation>NiMvJl4jIiIiNiNJJHNhdEc2IiomSSZTbG9wZUdGKUYmJiZJIkVHRik2I0kmcHVsc2VHRik2I0kkaWNpR0YpRiY=</Equation></Text-field></Output></Group><Group><Input><Text-field layout="Normal" style="Text">But, actually, Epulse varies a little bit, so, we take the energy  of the first pulse as a referrence.</Text-field><Text-field layout="Normal" style="Text">furthermore, we consider the back ground light (0 order after the AOM: non-resonant).</Text-field><Text-field layout="Normal" style="Text"> --&gt; We don't plot g(delta), but rather</Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">notation_,"ici",_cf_plus_bas;
'G(delta)' = g(delta) . ((E[pulse][ici] - E[pulse][ici][backgournd]) / (E[pulse][ici][ref] - E[pulse][ici][backgournd]));
G := G0               * ((E[pulse][ici] - E[pulse][ici][backgournd]) / (E[pulse][ici][ref] - E[pulse][ici][backgournd]));
Origin(G);</Text-field></Input><Output><Text-field layout="Maple Output" style="2D Output"><Equation>NiVJKm5vdGF0aW9uX0c2IlEkaWNpRiRJLV9jZl9wbHVzX2Jhc0dGJA==</Equation></Text-field><Text-field layout="Maple Output" style="2D Output"><Equation>NiMvLUkiR0c2IjYjSSZkZWx0YUdGJi1JIi5HNiRJKnByb3RlY3RlZEdGLEkoX3N5c2xpYkdGJjYkLUkiZ0dGJkYnKiYsJiYmSSJFR0YmNiNJJnB1bHNlR0YmNiNJJGljaUdGJiIiIiZGMzYjSStiYWNrZ291cm5kR0YmISIiRjosJiZGMzYjSSRyZWZHRiZGOkY7Rj5GPg==</Equation></Text-field><Text-field layout="Maple Output" style="2D Output"><Equation>NiM+SSJHRzYiKiosJiIiIkYoLUkkZXhwRzYkSSpwcm90ZWN0ZWRHRixJKF9zeXNsaWJHRiU2IywkSSZkZWx0YUdGJSEiIkYxRigsJiYmSSNPREdGJTYjSSVyZWFsR0YrNiNJJGxvd0dGJUYoRjBGMUYxLCYmJkkiRUdGJTYjSSZwdWxzZUdGJTYjSSRpY2lHRiVGKCZGOzYjSStiYWNrZ291cm5kR0YlRjFGKCwmJkY7NiNJJHJlZkdGJUYoRkJGMUYx</Equation></Text-field><Text-field layout="Maple Output" style="2D Output"><Equation>NiMqKiwmIiIiRiUtSSRleHBHNiRJKnByb3RlY3RlZEdGKUkoX3N5c2xpYkc2IjYjLCQtSSRjb2xHRis2I0kiYkdGKyEiIkYyRiUsJiZGLjYjIiM3RiVGLkYyRjIsJi1GLzYjSSJkR0YrRiUmRjhGNUYyRiUsJiZGODYjRiVGJUY7RjJGMg==</Equation></Text-field></Output></Group></Section><Group><Input><Text-field layout="Normal" style="Text"><Font size="24">To calculate OD_real, we will need only the ratio I0/Isat, </Font><Font size="14">and, 
to avoid errors coming from the measurement of the power of the laser with the power meter, we use the relative energies of the pulses for wich the camera is a good reference (as long as we don't change the area on which we look the intensity, neither the gain of the camera!!) :</Font></Text-field><Text-field layout="Normal" style="Text"><Font size="14">we will thus compare         <Font bold="true">I0=Epulse/T</Font> (what we call "ici")         and        <Font bold="true">Isat = Slope*Epulse <Font underline="true">of the "Isat measurement" experience</Font></Font> (what we call "av" for avant)

"ici" refers to data that were mesured in the very same series where we are calculating an expression.</Font></Text-field><Text-field layout="Normal" style="Text"><Font size="14">"av" refers to result that were extracted from a previous series, taken to measure Isat.</Font></Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">I[0]/I[sat] = E[pulse][ici] / Slope / E[pulse][av][ref] / T;</Text-field></Input><Output><Text-field layout="Maple Output" style="2D Output"><Equation>NiMvKiYmXiMiIiI2IyIiIUYnJkYmNiNJJHNhdEc2IiEiIioqJiZJIkVHRi02I0kmcHVsc2VHRi02I0kkaWNpR0YtRidJJlNsb3BlR0YtRi4mJkYxNiNJI2F2R0YtNiNJJHJlZkdGLUYuSSJUR0YtRi4=</Equation></Text-field></Output></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">OD_real := (1-exp(-delta))*E[pulse][ici]/Slope/E[pulse][av][ref]/T + delta;
Origin(OD_real);</Text-field></Input><Output><Text-field layout="Maple Output" style="2D Output"><Equation>NiM+SShPRF9yZWFsRzYiLCYqLCwmIiIiRiktSSRleHBHNiRJKnByb3RlY3RlZEdGLUkoX3N5c2xpYkdGJTYjLCRJJmRlbHRhR0YlISIiRjJGKSYmSSJFR0YlNiNJJnB1bHNlR0YlNiNJJGljaUdGJUYpSSZTbG9wZUdGJUYyJiZGNDYjSSNhdkdGJTYjSSRyZWZHRiVGMkkiVEdGJUYyRilGMUYp</Equation></Text-field><Text-field layout="Maple Output" style="2D Output"><Equation>NiMsJiosLCYiIiJGJi1JJGV4cEc2JEkqcHJvdGVjdGVkR0YqSShfc3lzbGliRzYiNiMsJC1JJGNvbEdGLDYjSSJiR0YsISIiRjNGJi1GMDYjSSJkR0YsRiYmLUYwNiNJImZHRiw2IyIjN0YzJkY4NiMiIzhGMy1GMDYjSSJhR0YsRjNGJkYvRiY=</Equation></Text-field></Output></Group><Section><Title><Text-field layout="Heading 1" style="Heading 1"><Font executable="false">Error bars on G(delta)</Font></Text-field></Title><Group><Input><Text-field layout="Normal" style="Text">we differentiate:</Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">G:=G:
error1g:=abs( diff(G, delta)) 		* Delta[delta] 		assuming positive: error1g:=simp(error1g);
error2g:=abs( diff(G, OD[real][low])) 	* Delta[OD[real][low]]	assuming positive: error2g:=simp(error2g);</Text-field></Input><Output><Text-field layout="Maple Output" style="2D Output"><Equation>NiM+SShlcnJvcjFnRzYiKiYmSSZEZWx0YUdGJTYjSSZkZWx0YUdGJSIiIi1JJGFic0dJKnByb3RlY3RlZEdGLjYjKiosJiYmSSJFR0YlNiNJJnB1bHNlR0YlNiNJJGljaUdGJUYrJkYyNiNJK2JhY2tnb3VybmRHRiUhIiJGKywqKiYtSSRleHBHNiRGLkkoX3N5c2xpYkdGJTYjLCRGKkY8RismJkkjT0RHRiU2I0klcmVhbEdGQTYjSSRsb3dHRiVGK0Y8KiZGP0YrRipGK0YrRj9GK0Y8RitGKywmRkVGPEYqRishIiMsJiZGMjYjSSRyZWZHRiVGK0Y5RjxGPEYr</Equation></Text-field></Output><Output><Text-field layout="Maple Output" style="2D Output"><Equation>NiM+SShlcnJvcjJnRzYiKi4sJi1JJGV4cEc2JEkqcHJvdGVjdGVkR0YrSShfc3lzbGliR0YlNiNJJmRlbHRhR0YlIiIiISIiRi9GLyZJJkRlbHRhR0YlNiMmJkkjT0RHRiU2I0klcmVhbEdGKjYjSSRsb3dHRiVGLy1JJGFic0dGKzYjLCYmJkkiRUdGJTYjSSZwdWxzZUdGJTYjSSRpY2lHRiVGLyZGPzYjSStiYWNrZ291cm5kR0YlRjBGLy1GPDYjLCYmRj82I0kkcmVmR0YlRi9GRkYwRjBGKEYwLCZGNEYvRi5GMCEiIw==</Equation></Text-field></Output></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">ErrorG := error1g+error2g;
Origin( ErrorG):
simp(simplify(%,size));</Text-field></Input><Output><Text-field layout="Maple Output" style="2D Output"><Equation>NiM+SSdFcnJvckdHNiIsJiomJkkmRGVsdGFHRiU2I0kmZGVsdGFHRiUiIiItSSRhYnNHSSpwcm90ZWN0ZWRHRi82IyoqLCYmJkkiRUdGJTYjSSZwdWxzZUdGJTYjSSRpY2lHRiVGLCZGMzYjSStiYWNrZ291cm5kR0YlISIiRiwsKiomLUkkZXhwRzYkRi9JKF9zeXNsaWJHRiU2IywkRitGPUYsJiZJI09ER0YlNiNJJXJlYWxHRkI2I0kkbG93R0YlRixGPSomRkBGLEYrRixGLEZARixGPUYsRiwsJkZGRj1GK0YsISIjLCYmRjM2I0kkcmVmR0YlRixGOkY9Rj1GLEYsKi4sJi1GQUYqRixGPUYsRiwmRik2I0ZGRiwtRi42I0YyRiwtRi42I0ZQRj1GVkY9LCZGRkYsRitGPUZPRiw=</Equation></Text-field></Output><Output><Text-field layout="Maple Output" style="2D Output"><Equation>NiMqLiwmKiosJi1JJGNvbEc2IjYjSSJiR0YpIiIiJkYnNiMiIzchIiIiIiMtRig2I0kiY0dGKUYsLUkkZXhwRzYkSSpwcm90ZWN0ZWRHRjhJKF9zeXNsaWJHRik2I0YnRiwtSSRhYnNHRjg2IywqKiZGJ0YsLUY2NiMsJEYnRjBGLEYwKiZGLUYsRkBGLEYsRkBGMEYsRixGLEYsKigsJkY1RixGMEYsRiwmRjJGLkYsLUY8NiMsJkYnRjBGLUYsRjFGLEYsLUY8NiMsJi1GKDYjSSJkR0YpRjAmRk1GLkYsRixGRyEiI0YmRlFGNUYwLUY8NiMsJiZGTTYjRixGLEZQRjBGMA==</Equation></Text-field></Output></Group></Section><Section><Title><Text-field layout="Heading 1" style="Heading 1">Error bars on OD_real</Text-field></Title><Group><Input><Text-field layout="Normal" style="Text">we differentiate:</Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">error1:=abs(simp( diff(OD_real, delta)))		* Delta[delta] 			assuming positive;
error2:=abs(simp( diff(OD_real, E[pulse][ici]))) 	* Delta[E[pulse][ici]] 		assuming positive;
error3:=abs(simp( diff(OD_real, Slope))) 		* Delta[Slope]			assuming positive;
error4:=abs(simp( diff(OD_real, E[pulse][av][ref]))) 	* Delta[E[pulse][av][ref]]	assuming positive;</Text-field></Input><Output><Text-field layout="Maple Output" style="2D Output"><Equation>NiM+SSdlcnJvcjFHNiIqLiwmKiomJiZJIkVHRiU2I0kmcHVsc2VHRiU2I0kjYXZHRiU2I0kkcmVmR0YlIiIiLUkkZXhwRzYkSSpwcm90ZWN0ZWRHRjdJKF9zeXNsaWJHRiU2I0kmZGVsdGFHRiVGM0kmU2xvcGVHRiVGM0kiVEdGJUYzRjMmRis2I0kkaWNpR0YlRjNGM0Y0ISIiRilGQEY7RkBGPEZAJkkmRGVsdGFHRiVGOUYz</Equation></Text-field><Text-field layout="Maple Output" style="2D Output"><Equation>NiM+SSdlcnJvcjJHNiIqLiwmLUkkZXhwRzYkSSpwcm90ZWN0ZWRHRitJKF9zeXNsaWJHRiU2I0kmZGVsdGFHRiUiIiIhIiJGL0YvRihGMCYmJkkiRUdGJTYjSSZwdWxzZUdGJTYjSSNhdkdGJTYjSSRyZWZHRiVGMEkiVEdGJUYwSSZTbG9wZUdGJUYwJkkmRGVsdGFHRiU2IyZGMzYjSSRpY2lHRiVGLw==</Equation></Text-field><Text-field layout="Maple Output" style="2D Output"><Equation>NiM+SSdlcnJvcjNHNiIqMCwmLUkkZXhwRzYkSSpwcm90ZWN0ZWRHRitJKF9zeXNsaWJHRiU2I0kmZGVsdGFHRiUiIiIhIiJGL0YvJiZJIkVHRiU2I0kmcHVsc2VHRiU2I0kkaWNpR0YlRi9GKEYwSSZTbG9wZUdGJSEiI0kiVEdGJUYwJiZGMjYjSSNhdkdGJTYjSSRyZWZHRiVGMCZJJkRlbHRhR0YlNiNGOEYv</Equation></Text-field><Text-field layout="Maple Output" style="2D Output"><Equation>NiM+SSdlcnJvcjRHNiIqMCwmLUkkZXhwRzYkSSpwcm90ZWN0ZWRHRitJKF9zeXNsaWJHRiU2I0kmZGVsdGFHRiUiIiIhIiJGL0YvJiZJIkVHRiU2I0kmcHVsc2VHRiU2I0kkaWNpR0YlRi9GKEYwSSZTbG9wZUdGJUYwSSJUR0YlRjAmJkYyNiNJI2F2R0YlNiNJJHJlZkdGJSEiIyZJJkRlbHRhR0YlNiNGOkYv</Equation></Text-field></Output></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">Error := error1+error2+error3+error4;
Origin( Error):
simp(%);</Text-field></Input><Output><Text-field layout="Maple Output" style="2D Output"><Equation>NiM+SSZFcnJvckc2IiwqKi4sJioqJiYmSSJFR0YlNiNJJnB1bHNlR0YlNiNJI2F2R0YlNiNJJHJlZkdGJSIiIi1JJGV4cEc2JEkqcHJvdGVjdGVkR0Y4SShfc3lzbGliR0YlNiNJJmRlbHRhR0YlRjRJJlNsb3BlR0YlRjRJIlRHRiVGNEY0JkYsNiNJJGljaUdGJUY0RjRGNSEiIkYqRkFGPEZBRj1GQSZJJkRlbHRhR0YlRjpGNEY0Ki4sJkY1RjRGQUY0RjRGNUZBRipGQUY9RkFGPEZBJkZDNiNGPkY0RjQqMEZFRjRGPkY0RjVGQUY8ISIjRj1GQUYqRkEmRkM2I0Y8RjRGNCowRkVGNEY+RjRGNUZBRjxGQUY9RkFGKkZJJkZDNiNGKkY0RjQ=</Equation></Text-field><Text-field layout="Maple Output" style="2D Output"><Equation>NiMqLCwoKigmLUkkY29sRzYiNiNJImZHRik2IyIjOCIiIi1GKDYjSSJkR0YpRi4mLUYoNiNJImdHRik2IyIjN0YuISIiKiYsJiomJkYzRixGLkYvRi5GOComLCYqJi1GKDYjSSJjR0YpRi5GL0YuRi4tRig2I0kiZUdGKUY4Ri5GJkYuRi5GLiZGJ0Y2Ri5GLiomLCgqKkYmIiIjLUYoNiNJImFHRilGLkZARi5GRkZKRi5GJUYuKiYsJiomRiZGLkZDRi5GLkY7Ri5GLkZGRi5GLkYuLUkkZXhwRzYkSSpwcm90ZWN0ZWRHRlRJKF9zeXNsaWJHRik2Iy1GKDYjSSJiR0YpRi5GLkYuRiYhIiNGS0Y4RkZGWkZRRjg=</Equation></Text-field></Output></Group></Section><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input"/></Input></Group><Text-field/><Text-field/></Worksheet>