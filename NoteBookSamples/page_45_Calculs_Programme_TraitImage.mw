<?xml version="1.0" encoding="UTF-8"?>
<Worksheet><Version major="6" minor="1"/><View-Properties><Zoom percentage="100"/></View-Properties><Styles><Layout alignment="left" bullet="none" firstindent="0.0" leftmargin="0.0" linebreak="space" linespacing="0.0" name="Normal" rightmargin="0.0" spaceabove="0.0" spacebelow="0.0"/><Layout alignment="centred" bullet="none" linespacing="0.5" name="Maple Output"/><Font background="[0,0,0]" bold="true" executable="true" family="Monospaced" foreground="[255,0,0]" name="Maple Input" opaque="false" size="12"/><Font background="[0,0,0]" bold="false" executable="false" family="Times New Roman" foreground="[0,0,0]" italic="false" name="Text" opaque="false" size="12" underline="false"/><Font background="[0,0,0]" family="Times New Roman" foreground="[0,0,255]" name="2D Output" opaque="false" readonly="true" size="12"/></Styles><Group><Text-field alignment="centred"><Font background="[0,0,0]" encoding="ISO8859-1" family="Times New Roman" size="16" underline="true">D'apr\350s le "AccesPixel.cpp" et "CFitting.cpp" du 11 Octobre 2005</Font></Text-field></Group><Group><Input><Text-field layout="Normal" style="Text">Calcul de l'absorption:</Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">restart;absorption = log ( abs(( valSansAt - valLeFond) / ( valAvecAt - valLeFond)) );</Text-field></Input><Output><Text-field layout="Maple Output" style="2D Output"><Equation style="2D Output">NiMvSSthYnNvcnB0aW9uRzYiLUkjbG5HNiRJKnByb3RlY3RlZEdGKUkoX3N5c2xpYkdGJTYjLUkkYWJzR0YpNiMqJiwmSSp2YWxTYW5zQXRHRiUiIiJJKnZhbExlRm9uZEdGJSEiIkYyLCZJKnZhbEF2ZWNBdEdGJUYyRjNGNEY0</Equation></Text-field></Output></Group><Group><Input><Text-field layout="Normal" style="Text"><Font encoding="ISO8859-1">Mis Sur une Echelle de 0 \340 255,    255 correspondant \340 une absorption valant  </Font><Font bold="true">m_ScaleAbsorption</Font></Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">absorption = absorption * 255 / m_ScaleAbsorption;</Text-field></Input><Output><Text-field layout="Maple Output" style="2D Output"><Equation style="2D Output">NiMvSSthYnNvcnB0aW9uRzYiLCQqJkYkIiIiSTJtX1NjYWxlQWJzb3JwdGlvbkdGJSEiIiIkYiM=</Equation></Text-field></Output></Group><Group><Input><Text-field layout="Normal" style="Text"><Font encoding="ISO8859-1">On fait saturer le r\351sultat \340 255, ou bien 0</Font></Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">absorption = min(255.0 ,  max(	0.0 , absorption) );</Text-field></Input><Output><Text-field layout="Maple Output" style="2D Output"><Equation style="2D Output">NiMvSSthYnNvcnB0aW9uRzYiLUkkbWluR0kqcHJvdGVjdGVkR0YoNiQkIiVdRCEiIi1JJG1heEdGKDYkRiQkIiIhRjE=</Equation></Text-field></Output></Group><Group><Input><Text-field layout="Normal" style="Text"><Font encoding="ISO8859-1">Alors, on peut convertir le double pr\351cision en "unsigned char" ie: un entier 8 bits</Font></Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">absorption = unsigned_char(absorption);</Text-field></Input><Output><Text-field layout="Maple Output" style="2D Output"><Equation style="2D Output">NiMvSSthYnNvcnB0aW9uRzYiLUkudW5zaWduZWRfY2hhckdGJTYjRiQ=</Equation></Text-field></Output></Group><Group><Input><Text-field layout="Normal" style="Text">La Dessus on ajuste une fonction:	comme pa exemple:</Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">z := Offset + Ampl_1 * ex_1 + Ampl_2 * ex_2;</Text-field></Input><Output><Text-field layout="Maple Output" style="2D Output"><Equation style="2D Output">NiM+SSJ6RzYiLChJJ09mZnNldEdGJSIiIiomSSdBbXBsXzFHRiVGKEklZXhfMUdGJUYoRigqJkknQW1wbF8yR0YlRihJJWV4XzJHRiVGKEYo</Equation></Text-field></Output></Group><Group><Input><Text-field layout="Normal" style="Text">Avec</Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">SinTheta:=(sin(theta)):	CosTheta:=(cos(theta)):
ex_1		:= exp(- ArgY_1 * ArgY_1);
ex_2		:= exp(- ArgY_2 * ArgY_2);
ArgY_1		:= ( X * SinTheta + Y * CosTheta - Y0_1 ) / SigmaY_1;
ArgY_2		:= ( X * SinTheta + Y * CosTheta - Y0_2 ) / SigmaY_2;</Text-field></Input><Output><Text-field layout="Maple Output" style="2D Output"><Equation style="2D Output">NiM+SSVleF8xRzYiLUkkZXhwRzYkSSpwcm90ZWN0ZWRHRilJKF9zeXNsaWJHRiU2IywkKiRJJ0FyZ1lfMUdGJSIiIyEiIg==</Equation></Text-field><Text-field layout="Maple Output" style="2D Output"><Equation style="2D Output">NiM+SSVleF8yRzYiLUkkZXhwRzYkSSpwcm90ZWN0ZWRHRilJKF9zeXNsaWJHRiU2IywkKiRJJ0FyZ1lfMkdGJSIiIyEiIg==</Equation></Text-field><Text-field layout="Maple Output" style="2D Output"><Equation style="2D Output">NiM+SSdBcmdZXzFHNiIqJiwoKiZJIlhHRiUiIiItSSRzaW5HNiRJKnByb3RlY3RlZEdGLkkoX3N5c2xpYkdGJTYjSSZ0aGV0YUdGJUYqRioqJkkiWUdGJUYqLUkkY29zR0YtRjBGKkYqSSVZMF8xR0YlISIiRipJKVNpZ21hWV8xR0YlRjc=</Equation></Text-field><Text-field layout="Maple Output" style="2D Output"><Equation style="2D Output">NiM+SSdBcmdZXzJHNiIqJiwoKiZJIlhHRiUiIiItSSRzaW5HNiRJKnByb3RlY3RlZEdGLkkoX3N5c2xpYkdGJTYjSSZ0aGV0YUdGJUYqRioqJkkiWUdGJUYqLUkkY29zR0YtRjBGKkYqSSVZMF8yR0YlISIiRipJKVNpZ21hWV8yR0YlRjc=</Equation></Text-field></Output></Group><Group><Input><Text-field layout="Normal" style="Text">Soit, pour theta = 0</Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">simplify(subs(theta=0,z));</Text-field></Input><Output><Text-field layout="Maple Output" style="2D Output"><Equation style="2D Output">NiMsKEknT2Zmc2V0RzYiIiIiKiZJJ0FtcGxfMUdGJUYmLUkkZXhwRzYkSSpwcm90ZWN0ZWRHRixJKF9zeXNsaWJHRiU2IywkKiYsJkkiWUdGJUYmSSVZMF8xR0YlISIiIiIjSSlTaWdtYVlfMUdGJSEiI0Y0RiZGJiomSSdBbXBsXzJHRiVGJi1GKjYjLCQqJiwmRjJGJkklWTBfMkdGJUY0RjVJKVNpZ21hWV8yR0YlRjdGNEYmRiY=</Equation></Text-field></Output></Group><Group><Input><Text-field layout="Normal" style="Text">L'ajustement nous rend les <Font bold="true">"pParamAjustables"   </Font><Font encoding="ISO8859-1">Mais en unit\351s logique : coordonn\351es d'\351cran (pixels), et intensit\351 d'\351cran (chiffre 8 bits)</Font>
Donc, on les transfert dans  <Font bold="true">"pLesResultatUnites" </Font><Font encoding="ISO8859-1">qui seront multipli\351s par les bonnes choses pour avoir de bonnes unit\351s</Font></Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">pLesResultatUnites[i] = pParamAjustables[i];</Text-field></Input><Output><Text-field layout="Maple Output" style="2D Output"><Equation style="2D Output">NiMvJkkzcExlc1Jlc3VsdGF0VW5pdGVzRzYiNiNJImlHRiYmSTFwUGFyYW1BanVzdGFibGVzR0YmRic=</Equation></Text-field></Output></Group><Group><Input><Text-field layout="Normal" style="Text"><Font encoding="ISO8859-1">Suivant le nom et l'unit\351 qu'on a d\351clar\351 dans le programme, on trouve le bon facteur... voil\340 quelques exemples :</Font></Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input"><Font encoding="ISO8859-1" foreground="[0,51,255]"># Suivant le nom ou l'unit\351, on multiplie par le bon facteur : 1/sqrt(2), PixelSize,...</Font><Font foreground="[0,0,255]">
pLesResultatUnites[i] = pLesResultatUnites[i]
				* (
				`if`(pLesNoms[i].Find("Del") &lt;&gt; -1	, (1/1.41421 * SIGN(pLesResultatUnites[i]))
									, 1.0	)	
				  ) 
				* (
				`if`(pLesUnites[i] = "mm"		, PixelSize						
									, 1.0	)
				  ):</Font></Text-field></Input></Group><Group><Input><Text-field layout="Normal" style="Text"><Font encoding="ISO8859-1">// Suivant le nom ou l'unit\351, on multiplie par le bon facteur : 1/sqrt(2), PixelSize,...</Font>
pLesResultatUnites[i] = pLesResultatUnites[i]
				* (
				`if`(pLesNoms[i].Find("Del") &lt;&gt; -1	, (1/1.41421 * SIGN(pLesResultatUnites[i]))
									, 1.0	)	
				  ) 
				* (
				`if`(pLesUnites[i] = "mm"		, PixelSize						
									, 1.0	)
				  ):</Text-field></Input></Group><Group><Input><Text-field layout="Normal" style="Text">...

</Text-field><Text-field layout="Normal" style="Text"/><Text-field layout="Normal" style="Text"/><Text-field layout="Normal" style="Text"/></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input"><Font foreground="[0,0,255]"># Si on a un mode absorption: on ne donne plus en /255, mais en D.O.  pour l'amplitude
if (AbsorpScaling &lt;&gt; 255 and pLesNoms[i].Find("Amp") &lt;&gt; -1)
then	
	pLesResultatUnites[i] = pLesResultatUnites[i] 
					* AbsorpScaling / 255:
	pLesUnites[i] = "O.D.":
elif (pLesNoms[i].Find("Amp") &lt;&gt; -1)
then 
	pLesUnites[i] = "/255":
fi:</Font></Text-field></Input></Group><Group><Input><Text-field layout="Normal" style="Text">// Si on a un mode absorption: on ne donne plus en /255, mais en D.O.  pour l'amplitude
if (AbsorpScaling &lt;&gt; 255 and pLesNoms[i].Find("Amp") &lt;&gt; -1)
then	
	pLesResultatUnites[i] = pLesResultatUnites[i] 
					* AbsorpScaling / 255:
	pLesUnites[i] = "O.D.":
elif (pLesNoms[i].Find("Amp") &lt;&gt; -1)
then 
	pLesUnites[i] = "/255":
fi:</Text-field></Input></Group><Group><Input><Text-field layout="Normal" style="Text">Voila pour l'affichage des Parametres Ajustables des Fit.
Maintenant, via la fonction <Font bold="true">"ScreenParamEnPlus", </Font><Font encoding="ISO8859-1">on peut afficher des parametres construit \340 partir d'autre donn\351es du programme.</Font>
Par exemple pour la <Font bold="true" encoding="ISO8859-1">densit\351e max \340 r\351sonnance</Font></Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">DO := sigma*Int( n_xyz, x=-infinity..infinity);_____________AVEC_____________;nMax:=n[max]:
n_xyz = nMax * exp(-(x^2+y^2)/2/Delta^2);
DO_y:=value(subs(%,DO)) assuming positive;</Text-field></Input><Output><Text-field layout="Maple Output" style="2D Output"><Equation style="2D Output">NiM+SSNET0c2IiomSSZzaWdtYUdGJSIiIi1JJEludEc2JEkqcHJvdGVjdGVkR0YsSShfc3lzbGliR0YlNiRJJm5feHl6R0YlL0kieEdGJTssJEkpaW5maW5pdHlHRiwhIiJGNEYo</Equation></Text-field><Text-field layout="Maple Output" style="2D Output"><Equation style="2D Output">NiNJP19fX19fX19fX19fX19BVkVDX19fX19fX19fX19fX0c2Ig==</Equation></Text-field><Text-field layout="Maple Output" style="2D Output"><Equation style="2D Output">NiMvSSZuX3h5ekc2IiomJkkibkdGJTYjSSRtYXhHSSpwcm90ZWN0ZWRHRisiIiItSSRleHBHNiRGK0koX3N5c2xpYkdGJTYjLCQqJiwmKiRJInhHRiUiIiNGLCokSSJ5R0YlRjdGLEYsSSZEZWx0YUdGJSEiIyMhIiJGN0Ys</Equation></Text-field><Text-field layout="Maple Output" style="2D Output"><Equation style="2D Output">NiM+SSVET195RzYiKi5JJnNpZ21hR0YlIiIiLUkkZXhwRzYkSSpwcm90ZWN0ZWRHRixJKF9zeXNsaWJHRiU2IywkKiZJJkRlbHRhR0YlISIjSSJ5R0YlIiIjIyEiIkY0RigmSSJuR0YlNiNJJG1heEdGLEYoRjQjRihGNEYxRihJI1BpR0YsRjs=</Equation></Text-field></Output></Group><Group><Input><Text-field layout="Normal" style="Text"><Font encoding="ISO8859-1">La Densit\351 Optique maximale vue en y = 0 vaut l'amplitude de la gaussienne centrale</Font></Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">DOMax := Ampl_1 = simplify(subs(y=0,DO_y));_____________AVEC_____________;
sigma=lambda^2/2/Pi;
nMax = solve(subs(%,DOMax),nMax);</Text-field></Input><Output><Text-field layout="Maple Output" style="2D Output"><Equation style="2D Output">NiM+SSZET01heEc2Ii9JJ0FtcGxfMUdGJSosSSZzaWdtYUdGJSIiIiZJIm5HRiU2I0kkbWF4R0kqcHJvdGVjdGVkR0YvRioiIiMjRipGMEkmRGVsdGFHRiVGKkkjUGlHRi9GMQ==</Equation></Text-field><Text-field layout="Maple Output" style="2D Output"><Equation style="2D Output">NiNJP19fX19fX19fX19fX19BVkVDX19fX19fX19fX19fX0c2Ig==</Equation></Text-field><Text-field layout="Maple Output" style="2D Output"><Equation style="2D Output">NiMvSSZzaWdtYUc2IiwkKiZJJ2xhbWJkYUdGJSIiI0kjUGlHSSpwcm90ZWN0ZWRHRishIiIjIiIiRik=</Equation></Text-field><Text-field layout="Maple Output" style="2D Output"><Equation style="2D Output">NiMvJkkibkc2IjYjSSRtYXhHSSpwcm90ZWN0ZWRHRikqLEknQW1wbF8xR0YmIiIiSSNQaUdGKSNGLCIiI0knbGFtYmRhR0YmISIjRi9GLkkmRGVsdGFHRiYhIiI=</Equation></Text-field></Output></Group><Group><Input><Text-field layout="Normal" style="Text"><Font encoding="ISO8859-1">D'o\371 :</Font></Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input"><Font encoding="ISO8859-1" foreground="[0,0,255]"># Si la premiere gaussienne est la plus fine, ou si on est \340 la deuxi\350me chance (ie: qu'on a fix\351 Del_2 en posant </Font><Font foreground="[0,0,255]">TheIa[7]=0)
`if`(pParamAjustables[2] &lt; pParamAjustables[6] or TheIa[7]=0
		, 1e-10 * pLesResultatUnites[0] / (pLesResultatUnites[2] / 10.0) * sqrt(6.2830) / (780e-7) / (780e-7)
		, 1e-10 * pLesResultatUnites[4] / (pLesResultatUnites[6] / 10.0) * sqrt(6.2830) / (780E-7) / (780E-7)
    ):</Font></Text-field></Input></Group><Group><Input><Text-field layout="Normal" style="Text"><Font encoding="ISO8859-1">// Si la premiere gaussienne est la plus fine, ou si on est \340 la deuxi\350me chance (ie: qu'on a fix\351 Del_2 en posant TheIa[7]=0)</Font>
`if`(pParamAjustables[2] &lt; pParamAjustables[6] or TheIa[7]=0
		, 1e-10 * pLesResultatUnites[0] / (pLesResultatUnites[2] / 10.0) * sqrt(6.2830) / (780e-7) / (780e-7)
		, 1e-10 * pLesResultatUnites[4] / (pLesResultatUnites[6] / 10.0) * sqrt(6.2830) / (780E-7) / (780E-7)
    ):</Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input"/></Input></Group><Text-field/><Text-field/><Text-field/></Worksheet>