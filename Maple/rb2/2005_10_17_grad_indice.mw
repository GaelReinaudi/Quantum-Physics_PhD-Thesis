<?xml version="1.0" encoding="UTF-8"?>
<Worksheet><Version major="6" minor="1"/><View-Properties><Zoom percentage="100"/></View-Properties><Styles><Layout alignment="left" bullet="none" name="Warning"/><Layout alignment="left" bullet="none" firstindent="0.0" leftmargin="0.0" linebreak="space" name="Normal" rightmargin="0.0" spaceabove="0.0" spacebelow="0.0"/><Layout alignment="centred" bullet="none" name="Maple Plot"/><Layout alignment="centred" bullet="none" linespacing="0.5" name="Maple Output"/><Font background="[0,0,0]" bold="true" executable="true" family="Monospaced" foreground="[255,0,0]" name="Maple Input" opaque="false" size="12"/><Font background="[0,0,0]" bold="false" executable="false" family="Times New Roman" foreground="[0,0,0]" italic="false" name="Text" opaque="false" size="12" underline="false"/><Font background="[0,0,0]" family="Monospaced" foreground="[0,0,255]" name="Warning" opaque="false" readonly="true" size="12"/><Font background="[0,0,0]" family="Times New Roman" foreground="[0,0,255]" name="2D Output" opaque="false" readonly="true" size="12"/></Styles><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">restart;</Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">UseHardwareFloats :=true;</Text-field></Input><Output><Text-field layout="Maple Output" style="2D Output"><Equation>NiM+STJVc2VIYXJkd2FyZUZsb2F0c0c2IkkldHJ1ZUdJKnByb3RlY3RlZEdGJw==</Equation></Text-field></Output></Group><Group><Input><Text-field layout="Normal" style="Text">cf : http://www.lmov.uvsq.fr/~prd/projets0304/projet4.htm</Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">Digits:=15;</Text-field></Input><Output><Text-field layout="Maple Output" style="2D Output"><Equation>NiM+SSdEaWdpdHNHNiIiIzo=</Equation></Text-field></Output></Group><Group><Input><Text-field prompt="&gt; " style="Maple Input">densite_au_centre := 1e10/(1e-2)^3;
Delta := 250e-6;
#r:=sqrt(x^2+y^2);</Text-field></Input><Output><Text-field layout="Maple Output" style="2D Output"><Equation>NiM+STJkZW5zaXRlX2F1X2NlbnRyZUc2IiQiMCsrKysrKysiIiIj</Equation></Text-field><Text-field layout="Maple Output" style="2D Output"><Equation>NiM+SSZEZWx0YUc2IiQiJF0jISIn</Equation></Text-field></Output></Group><Group><Input><Text-field layout="Normal" style="Text"><Font encoding="ISO8859-1">Les donn\351es du probl\350me</Font></Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">valeurs := [lambda=780e-9, delta=1, sigma0=780e-9^2/2/evalf(Pi)];
sigma0:=3/2*lambda^2/Pi		/3	;
lambda:=780e-9;
delta:=+1;
sigma0:=evalf(sigma0);</Text-field></Input><Output><Text-field layout="Maple Output" style="2D Output"><Equation>NiM+SSh2YWxldXJzRzYiNyUvSSdsYW1iZGFHRiUkIiQheSEiKi9JJmRlbHRhR0YlIiIiL0knc2lnbWEwR0YlJCIwIzRyUG4pSG8qISNH</Equation></Text-field><Text-field layout="Maple Output" style="2D Output"><Equation>NiM+SSdzaWdtYTBHNiIsJComSSdsYW1iZGFHRiUiIiNJI1BpR0kqcHJvdGVjdGVkR0YrISIiIyIiIkYp</Equation></Text-field><Text-field layout="Maple Output" style="2D Output"><Equation>NiM+SSdsYW1iZGFHNiIkIiQheSEiKg==</Equation></Text-field><Text-field layout="Maple Output" style="2D Output"><Equation>NiM+SSZkZWx0YUc2IiIiIg==</Equation></Text-field><Text-field layout="Maple Output" style="2D Output"><Equation>NiM+SSdzaWdtYTBHNiIkIjAjNHJQbilIbyohI0c=</Equation></Text-field></Output></Group><Group><Input><Text-field layout="Normal" style="Text"><Font encoding="ISO8859-1" size="16">d\351finisson un profil de densit\351 d'atomes...</Font></Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">n_at:=(x,y)-&gt;exp(-(x^2+y^2)/2/Delta^2);
plot([n_at(x,0),[[Delta,0],[Delta,1]],[[-Delta,0],[-Delta,1]]],x=-4*Delta..4*Delta, color=[red,green,green]);</Text-field></Input><Output><Text-field layout="Maple Output" style="2D Output"><Equation>NiM+SSVuX2F0RzYiZio2JEkieEdGJUkieUdGJUYlNiRJKW9wZXJhdG9yR0YlSSZhcnJvd0dGJUYlLUkkZXhwR0YlNiMsJComLCYqJDkkIiIjIiIiKiQ5JUY1RjZGNkkmRGVsdGFHRiUhIiMjISIiRjVGJUYlRiU=</Equation></Text-field></Output><Output><Text-field layout="Maple Plot"><Plot height="400" plot-scale="1.0" plot-xtrans="0.0" plot-ytrans="0.0" type="two-dimensional" width="400">LSUlUExPVEc2Jy0lJ0NVUlZFU0c2JDddbzckJCEzLSsrKysrKys1ISM/JCIzYT1eLXppaWFMISNANyQkITMjKnBtbTtwMGsmKkYvJCIzITNnPypRUyFwaidGLzckJCEzUUlMJDM8WFo9KkYvJCIzL1BhQipIR0I8IkYsNyQkITM7cW1tVCVwImUoKUYvJCIzTWkqPXFHLkU7I0YsNyQkITNfcG1tIjRtKEckKUYvJCIzI3BYMiMpZkYmKilRRiw3JCQhMyQpSEwkM2kuOSF6Ri8kIjNjU3RqLFVndW5GLDckJCEzXWdtOy9SPTB2Ri8kIjNzJTR5SzwzUzUiISM+NyQkITNfKytdUDgjXDQoRi8kIjN5bFwuK11yI3kiRk43JCQhM19nbTsvc2lxbUYvJCIzblJDR2VVXVdHRk43JCQhM2cqKioqXCh5JHBaaUYvJCIzWCEzIUdzZiRRUyVGTjckJCEzJSlITEwkeWFFImVGLyQiM2klM2cjUjtyK25GTjckJCEzXGdtbSI+cyVIYUYvJCIzK2cqZlIjNHhkJSpGTjckJCEzISoqKioqKipcJCo0KSpcRi8kIjMzTS0nZiE9VGI4ISM9NyQkITN3KioqKioqXF8mXGMlRi8kIjMjMyZ5IzNyRnopPUZnbzckJCEzIyoqKioqKipcMWFaVEYvJCIzPVRFQFNlV0RERmdvNyQkITNBZ207LyMpW29QRi8kIjNDJCpSa1RDaTVLRmdvNyQkITMkKUhMTCQ9ZXhKJEYvJCIzRyZSJ1tXWkxYVEZnbzckJCEzNUlMTGVXJW83JEYvJCIzS0pAUFk/NnVYRmdvNyQkITMlKUhMTEwyJGYkSEYvJCIzb3JuNEpAKnksJkZnbzckJCEzdGZtVCZvX1FyI0YvJCIzK1R6XVEzclpiRmdvNyQkITM9ISoqKlxQWXgiXCNGLyQiM3FMUkJqQUUmMydGZ283JCQhMycqZm1UTno+JkgjRi8kIjNpMTZwLyVbNWMnRmdvNyQkITMrSUxMTDdpKTQjRi8kIjNsS3c6akJWSXFGZ283JCQhMzchKioqXFAncHNtIkYvJCIzKCpRZU13ajMxISlGZ283JCQhMzUhKioqXDc0X2M3Ri8kIjM4O3A2d3JWOCkpRmdvNyQkITNFK0xMJDN4JXojKSEjQSQiMycqNF4yU3pPbSUqRmdvNyQkITNHK0wkZTlkO0onRmdzJCIzI1EnZkk3KEdqbypGZ283JCQhM0grTEwzcyRRTSVGZ3MkIjM7Vng8SkE9XSkqRmdvNyQkITNxPm1UJlFkREckRmdzJCIzSTNqVzAhcFQiKipGZ283JCQhMycqXCoqXGl2RkBBRmdzJCIzJzNBKHo0X2dnKipGZ283JCQhMy8hRyRlUngqKmY2RmdzJCIzISkzYyhRLlQjKikqKkZnbzckJCEzZysrbW07enIpKiEjQyQiM1NNdFtRPyMqKioqKkZnbzckJCIzbSpcJDN4InlZXyUhI0IkIjNtNWs1PEJPKSoqKkZnbzckJCIzMStMM19ObC41RmdzJCIzKSpwJUhEb1c+KioqRmdvNyQkIjMzXSNla0dSW2IiRmdzJCIzQ0JgWSlbeTEpKipGZ283JCQiMzQrSyQzLURnNSNGZ3MkIjN1M0xyWCxlayoqRmdvNyQkIjN5KjQkZSpbJ1IzS0ZncyQiM1llbiFvbygpeiIqKkZnbzckJCIzIikqKkhMZXp3NVZGZ3MkIjNxdiJwdHpQQyYpKkZnbzckJCIzMStsbW1KK0lpRmdzJCIzNSQpRyNwZm5VcCpGZ283JCQiM2sqKioqKlxQUSNcIilGZ3MkIjNhLzMqSGkmZSNbKkZnbzckJCIzJCoqSEwkZSIqW0g3Ri8kIjMlKW9PMmptJTQnKSlGZ283JCQiMzMrKysrZHhkO0YvJCIzJj5zQ01uSWotKUZnbzckJCIzMSsrK0QweHc/Ri8kIjNNPihmXiZSJD4zKEZnbzckJCIzLSsrdlYrWnpBRi8kIjMhUSZHJ1tqQSopZidGZ283JCQiM0UrK11pJnBAWyNGLyQiMyRRInpTIXBrJjNoRmdvNyQkIjM6Kyt2PUdCMkZGLyQiM0FfRXA9NG1qYkZnbzckJCIzMisrK3ZnSEtIRi8kIjMyZCMzJ3A6WUVdRmdvNyQkIjM6XUwkM1VEWDgkRi8kIjNxOXFlNHJhY1hGZ283JCQiM0Irbm1tWnZPTEYvJCIzMCZSNzoyQ081JUZnbzckJCIzJSoqKioqKipcMmdvUEYvJCIzbFdgZXJYUzVLRmdvNyQkIjM5K0wkZVI8KmZURi8kIjN2dSted3l2L0RGZ283JCQiMysrKytdKUh4ZSVGLyQiMzUwOCp6J2VxYz1GZ283JCQiM2kqcG0iSCFvLSpcRi8kIjNLWGIhUUQ/Uk8iRmdvNyQkIjNlKioqKlw3ay42YUYvJCIzI1FPRi9cKj41JypGTjckJCIzeSpwbW1UOUMjZUYvJCIzUiR6YnooZTZTbUZONyQkIjNdKytdaSEqM2BpRi8kIjNvU1VpbSZRLFElRk43JCQiM1krTExMKnp5bSdGLyQiM1cqUkJoS2JHJkdGTjckJCIzUytMTDNOMSM0KEYvJCIzT2JEU2NtXSl5IkZONyQkIjNeKnBtIkhZdDd2Ri8kIjNlKnkxJ1IjUVM0IkZONyQkIjNLKysrK3hHKip5Ri8kIjMhW2VwKSkzW0Z6J0YsNyQkIjMxK25tVDZLVSQpRi8kIjMtZ00jPnVWKT5RRiw3JCQiM0ErTExMYmRRKClGLyQiM0tEQCo+XE9GQSNGLDckJCIzKysrXWlgMWgiKkYvJCIzIXl3KUchcCh5ODdGLDckJCIzIykqKioqXFA/V2wmKkYvJCIzSkAkND5aXUdpJ0YvNyQkIjMtKysrKysrKzVGLEYtLSUmQ09MT1JHNiYlJFJHQkckIiM1ISIiJCIiIUZjYGxGZGBsLUYmNiQ3JDckJCIzMSsrKysrKytERi8kRmVgbEZlYGw3JEZqYGwkIiIiRmVgbC1GXmBsNiZGYGBsRmRgbEZhYGxGZGBsLUYmNiQ3JDckJCEzMSsrKysrKytERi9GXGFsNyRGZmFsRl5hbEZgYWwtJStBWEVTTEFCRUxTRzYkUSJ4NiJRIUZdYmwtJSVWSUVXRzYkOyQhIzUhIiUkRmJgbEZlYmw7JCEiI0ZpYmwkIiQtIkZpYmw=</Plot></Text-field></Output></Group><Group><Input><Text-field layout="Normal" style="Text">Ou encore :<Font encoding="ISO8859-1">
une petite proc\351dure qui d\351finit un plateau avec une largeur, une largeur de pente, et une variable</Font></Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">plateau:=proc(largeur,rampe,var)
(1+tanh((-var+largeur/2)*3/rampe))/2 ;
end:</Text-field></Input></Group><Group><Input><Text-field layout="Normal" style="Text">qui donne</Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">n_at:=(x,y)-&gt;plateau(2*Delta,Delta/1,sqrt(x^2+y^2)):
'n_at(x,y)' = n_at(x,y);
plot([n_at(x,0),[[Delta,0],[Delta,1]],[[-Delta,0],[-Delta,1]]],x=-4*Delta..4*Delta, color=[red,green,green]);</Text-field></Input><Output><Text-field layout="Maple Output" style="2D Output"><Equation>NiMvLUklbl9hdEc2IjYkSSJ4R0YmSSJ5R0YmLCYjIiIiIiIjRiwtSSV0YW5oRzYkSSpwcm90ZWN0ZWRHRjFJKF9zeXNsaWJHRiY2IywmKiQsJiokRihGLUYsKiRGKUYtRixGKyQiMCsrKysrKz8iISM1JCEwKysrKysrKyQhIzlGLCMhIiJGLQ==</Equation></Text-field></Output><Output><Text-field layout="Maple Plot"><Plot height="400" plot-scale="1.0" plot-xtrans="0.0" plot-ytrans="0.0" type="two-dimensional" width="400">LSUlUExPVEc2Jy0lJ0NVUlZFU0c2JDdbcDckJCEzLSsrKysrKys1ISM/JCIzeGNrKCpceipIXyIhI0Q3JCQhMyMqcG1tO3AwayYqISNAJCIzZ1MoSFNna2ZMJUYvNyQkITNRSUwkMzxYWj0qRjMkIjM1SVdfPyZvdjIiISNDNyQkITM7cW1tVCVwImUoKUYzJCIzPWpcK0kjSCcqKkhGOzckJCEzX3BtbSI0bShHJClGMyQiM3NyYSpcX0dwUylGOzckJCEzJClITCQzaS45IXpGMyQiM2l2WWpSemxXQiEjQjckJCEzXWdtOy9SPTB2RjMkIjMvVmEpKm9tP29nRks3JCQhM18rK11QOCNcNChGMyQiMypSc3BXP01WaSIhI0E3JCQhM19nbTsvc2lxbUYzJCIzV1YhPidbNyVvXCVGVjckJCEzZyoqKipcKHkkcFppRjMkIjNBPCRIW2kkelM3RjM3JCQhMyUpSExMJHlhRSJlRjMkIjMzVXd6diVwU18kRjM3JCQhM1xnbW0iPnMlSGFGMyQiMzIkKT5odic9XSQpKUYzNyQkITMhKioqKioqKlwkKjQpKlxGMyQiMzMlKUdwZikqKlFbI0YsNyQkITN3KioqKioqXF8mXGMlRjMkIjNJZFlVdT1iIypwRiw3JCQhMyUpKioqKioqXHpDY1ZGMyQiM0cheXomKlwqb1s2ISM+NyQkITMjKioqKioqKlwxYVpURjMkIjMjUmNDLnA7Oik9RmRwNyQkITMhKUhMM0ZXLGVSRjMkIjNVJ3pkSmUsTSRIRmRwNyQkITNBZ207LyMpW29QRjMkIjN5eV8oNG0zaGElRmRwNyQkITMhKioqKlxQPkJKYSRGMyQiM11kQEUnUls4YyhGZHA3JCQhMyQpSExMJD1leEokRjMkIjNydTdrPiNRPUIiISM9NyQkITM1SUxMZVclbzckRjMkIjNJV0NJXkFtPD1GXnI3JCQhMyUpSExMTDIkZiRIRjMkIjMpNG40JXkoKlsqZiNGXnI3JCQhM0ArXVA0PCpbI0dGMyQiMyV6V2ppLWZQOSRGXnI3JCQhM3RmbVQmb19RciNGMyQiM0RAJipRPnpLV1BGXnI3JCQhMyEpPiRlOW04R2cjRjMkIjNXQzYkWzRIaVElRl5yNyQkITM9ISoqKlxQWXgiXCNGMyQiMzM+RU1zME5cXUZecjckJCEzIyo+JGVrRydbJFIjRjMkIjNdKDQsY2pDY2omRl5yNyQkITMnKmZtVE56PiZII0YzJCIzYFAjZSJwZ2wvaUZecjckJCEzKSoqKlxQJWU0cD4jRjMkIjNVUkJJWj5RVW5GXnI3JCQhMytJTExMN2kpNCNGMyQiMy4rd2oxJVF5QihGXnI3JCQhMzFnbVROYSVIKT1GMyQiM0c7XiJ5YUpyOSlGXnI3JCQhMzchKioqXFAncHNtIkYzJCIzd2EoRydbMFgxKSlGXnI3JCQhMykqKikqKipcRiYqPVkiRjMkIjM3cmtuKlwuYUIqRl5yNyQkITM1ISoqKlw3NF9jN0YzJCIzJXpTUm51Pyc9JipGXnI3JCQhMzFnbVQ1VkJVNUYzJCIzUVVqWjopKlsxKCpGXnI3JCQhM0UrTEwkM3gleiMpRlYkIjMkUiFlW0VuU0EpKkZecjckJCEzRytMJGU5ZDtKJ0ZWJCIzcVMqXCRINF4pKSkqRl5yNyQkITNIK0xMM3MkUU0lRlYkIjNJIiozO2FYPUkqKkZecjckJCEzJypcKipcaXZGQEFGViQiM0NcLmtaViR6JioqRl5yNyQkITNnKyttbTt6cikqRjskIjNxXE05YENvdSoqRl5yNyQkIjM0K0skMy1EZzUjRlYkIjM3X3MjeUV4IWYqKkZecjckJCIzIikqKkhMZXp3NVZGViQiM2hyLCpvaksyJCoqRl5yNyQkIjMxK2xtbUorSWlGViQiMyM+VTYiWzNsISopKkZecjckJCIzayoqKioqXFBRI1wiKUZWJCIzdSJwNCdHeXhGKSpGXnI3JCQiMyYqXG0ielwxQS0iRjMkIjNgKTRhKlskeSk+KCpGXnI3JCQiMyQqKkhMJGUiKltIN0YzJCIzKSl5QUYpKjRcWiYqRl5yNyQkIjMsXW07SENqVjlGMyQiM1UqeVw+OSZ5bCMqRl5yNyQkIjMzKysrK2R4ZDtGMyQiM2QnKVJyTEs+SSkpRl5yNyQkIjMxKytdN0pGbj1GMyQiMzUxIipRXzBDLiMpRl5yNyQkIjMxKysrRDB4dz9GMyQiM2V1ckEicFM5TShGXnI3JCQiMy8rXVAlRz8ieUBGMyQiM0p4IzRnIipRMSVvRl5yNyQkIjMtKyt2VitaekFGMyQiM0MybkpxRjgkSCdGXnI3JCQiMysrXTcuKT4zUSNGMyQiMzRmNl8tYUM1ZEZecjckJCIzRSsrXWkmcEBbI0YzJCIzeEEjUT9JbXA1JkZecjckJCIzPytdaSE+LFpmI0YzJCIzYk1HcipIRVVWJUZecjckJCIzOisrdj1HQjJGRjMkIjMpelhNSHA6O3kkRl5yNyQkIjM2K10ob1drKD5HRjMkIjMlWyk9JD4qSE1xSkZecjckJCIzMisrK3ZnSEtIRjMkIjMnSFc/cjkxamgjRl5yNyQkIjM6XUwkM1VEWDgkRjMkIjNhcTRNdWdTIXoiRl5yNyQkIjNCK25tbVp2T0xGMyQiM08nKW9eZFlWJD0iRl5yNyQkIjMzXUxMZXhuX05GMyQiM2lOLjU8O2ktdUZkcDckJCIzJSoqKioqKipcMmdvUEYzJCIzZmZxUHptJFxhJUZkcDckJCIzd1xtIkgyZlUnUkYzJCIzO0E/ZXJ2LSIqR0ZkcDckJCIzOStMJGVSPCpmVEYzJCIzRzw1OicqZlhGPUZkcDckJCIzISlcbSJIaUJRUCVGMyQiM0omSFUwUG08NSJGZHA3JCQiMysrKytdKUh4ZSVGMyQiM3M9XHc1cDFCbUYsNyQkIjNpKnBtIkghby0qXEYzJCIzUkFmNihSMjRgI0YsNyQkIjNlKioqKlw3ay42YUYzJCIzRnpcUCN6UlZCKkYzNyQkIjN5KnBtbVQ5QyNlRjMkIjMhZUIheSMzN0RXJEYzNyQkIjNdKytdaSEqM2BpRjMkIjNkZ29IUUQkW0EiRjM3JCQiM1krTExMKnp5bSdGMyQiM0hqOTNpdmVFWEZWNyQkIjNTK0xMM04xIzQoRjMkIjM/Ulo1JEc4YmoiRlY3JCQiM14qcG0iSFl0N3ZGMyQiMz0mKWY3YjdCZmZGSzckJCIzSysrKyt4RyoqeUYzJCIzN08pPi8nW2ZjQkZLNyQkIjMxK25tVDZLVSQpRjMkIjM1I1IqZXRWJHk4KUY7NyQkIjNBK0xMTGJkUSgpRjMkIjNmYG9oa3IwV0pGOzckJCIzKysrXWlgMWgiKkYzJCIzYTJkUjQ/ZVM2Rjs3JCQiMyMpKioqKlxQP1dsJipGMyQiM1speWk6YHU6SyVGLzckJCIzLSsrKysrKys1RixGLS0lJkNPTE9SRzYmJSRSR0JHJCIjNSEiIiQiIiFGamRsRltlbC1GJjYkNyQ3JCQiMzErKysrKysrREYzJEZcZWxGXGVsNyRGYWVsJCIiIkZcZWwtRmVkbDYmRmdkbEZbZWxGaGRsRltlbC1GJjYkNyQ3JCQhMzErKysrKysrREYzRmNlbDckRl1mbEZlZWxGZ2VsLSUrQVhFU0xBQkVMU0c2JFEieDYiUSFGZGZsLSUlVklFV0c2JDskISM1ISIlJEZpZGxGXGdsOyQhIiNGYGdsJCIkLSJGYGds</Plot></Text-field></Output></Group><Group><Input><Text-field layout="Normal" style="Text"><Font encoding="ISO8859-1" size="16">On d\351finit d\351finit l'indice r\351el             "n_ref"  :  r\351fraction</Font><Font size="16">
                         et l'indice complexe   "n_abs" :  asbsorption</Font></Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">n_ref:=1 + n_at * sigma0 * lambda/4/(Pi) * (-delta)/(1+delta^2)	*densite_au_centre;
n_abs:=    n_at * sigma0 * lambda/4/(Pi) * 1/(1+delta^2)		*densite_au_centre;
#evalf(sigma0 * lambda/4/Pi * delta/(1+delta^2))	*densite_au_centre; limit(%/ddelta,ddelta=delta);
simplify(n_ref(x,y));
simplify(n_abs(x,y));</Text-field></Input><Output><Text-field layout="Maple Output" style="2D Output"><Equation>NiM+SSZuX3JlZkc2IiwmIiIiRicqJkklbl9hdEdGJUYnSSNQaUdJKnByb3RlY3RlZEdGKyEiIiQhMDpvI3A/IjRXKiEjPg==</Equation></Text-field><Text-field layout="Maple Output" style="2D Output"><Equation>NiM+SSZuX2Fic0c2IiwkKiZJJW5fYXRHRiUiIiJJI1BpR0kqcHJvdGVjdGVkR0YrISIiJCIwOm8jcD8iNFcqISM+</Equation></Text-field><Text-field layout="Maple Output" style="2D Output"><Equation>NiMsJiQiMG88S3VcKSoqKiohIzoiIiItSSV0YW5oRzYkSSpwcm90ZWN0ZWRHRitJKF9zeXNsaWJHNiI2IywmKiQsJiokSSJ4R0YtIiIjRicqJEkieUdGLUY0RicjRidGNCQiJis/IiIiISQhIiRGOkYnJCIwJyo+SiN5Yy06ISM+</Equation></Text-field><Text-field layout="Maple Output" style="2D Output"><Equation>NiMsJiQiMCcqPkojeWMtOiEjPiIiIi1JJXRhbmhHNiRJKnByb3RlY3RlZEdGK0koX3N5c2xpYkc2IjYjLCYqJCwmKiRJInhHRi0iIiNGJyokSSJ5R0YtRjRGJyNGJ0Y0JCImKz8iIiIhJCEiJEY6RickITAnKj5KI3ljLTpGJg==</Equation></Text-field></Output></Group><Group><Input><Text-field layout="Normal" style="Text"><Font encoding="ISO8859-1" size="16">On en prend le gradient de l'indice de r\351fraction :</Font></Text-field><Text-field layout="Normal" style="Text"><Font encoding="ISO8859-1">on en fait une proc\351dure : grad_n:=proc(x,y) </Font></Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">VectorCalculus[Gradient](n_ref(x,y),[x,y]):
gradn:=simplify(convert(   %   ,Vector));
grad_n:=proc(xx,yy) 
global gradn;
subs([x=xx,y=yy],eval(gradn));
end:</Text-field></Input><Output><Text-field layout="Maple Output" style="2D Output"><Equation>NiM+SSZncmFkbkc2Ii1JJ1JUQUJMRUdGJTYlIil3aiRHJC1JJ01BVFJJWEdGJTYjNyQ3IywkKigsJiQhIiIiIiEiIiIqJC1JJXRhbmhHNiRJKnByb3RlY3RlZEdGOkkoX3N5c2xpYkdGJTYjLCYqJCwmKiRJInhHRiUiIiNGNSokSSJ5R0YlRkJGNSNGNUZCJCImKz8iRjQkISIkRjRGNUZCRjVGNUZBRjVGPyNGM0ZCJCEwJlJ1KFEiMy49ISM6NyMsJCooRjFGNUZERjVGP0ZKRksmSSdWZWN0b3JHRjk2I0knY29sdW1uR0Yl</Equation></Text-field></Output></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">grad_n(-2*Delta,3*Delta);</Text-field></Input><Output><Text-field layout="Maple Output" style="2D Output"><Equation>NiMtSSdSVEFCTEVHNiI2JSIpQypmOiQtSSdNQVRSSVhHRiU2IzckNyMsJCoqLCYkISIiIiIhIiIiKiQtSSV0YW5oRzYkSSpwcm90ZWN0ZWRHRjhJKF9zeXNsaWJHRiU2IywmKiYiIzgjRjMiIiMqJEkqZGVtaWxhcmdlR0YlRj9GPiQiJis/IkYyJCEiJEYyRjNGP0YzRjNGQUYzRj1GPkZAI0YxRj8kIjAjKmZkT3JSeCMhIzs3IywkRi4kITAqKVInW3EmNDslRkkmSSdWZWN0b3JHRjc2I0knY29sdW1uR0Yl</Equation></Text-field></Output></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input"><Font encoding="ISO8859-1" foreground="[0,51,255]">				####	d\351finissons le vecteur unitaire tangent \340 la trajectoire d'un rayon</Font>
T:=convert([Tx,Ty],Vector);</Text-field></Input><Output><Text-field layout="Maple Output" style="2D Output"><Equation>NiM+SSJURzYiLUknUlRBQkxFR0YlNiUiKS8tY0otSSdNQVRSSVhHRiU2IzckNyNJI1R4R0YlNyNJI1R5R0YlJkknVmVjdG9yRzYkSSpwcm90ZWN0ZWRHRjVJKF9zeXNsaWJHRiU2I0knY29sdW1uR0Yl</Equation></Text-field></Output></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">T . grad_n(x,y) assuming Tx::real,Ty::real;		<Font encoding="ISO8859-1" foreground="[51,51,255]">####	pour aboutir \340 dT/ds</Font>
gradnTT:=simplify(convert(%*T,Vector),size) ;</Text-field></Input><Output><Text-field layout="Maple Output" style="2D Output"><Equation>NiMsJioqSSNUeEc2IiIiIiwmJCEiIiIiIUYnKiQtSSV0YW5oRzYkSSpwcm90ZWN0ZWRHRjBJKF9zeXNsaWJHRiY2IywmKiQsJiokSSJ4R0YmIiIjRicqJEkieUdGJkY4RicjRidGOCQiJis/IkYrJCEiJEYrRidGOEYnRidGN0YnRjUjRipGOCQhMCZSdShRIjMuPSEjOioqSSNUeUdGJkYnRihGJ0Y6RidGNUZARkE=</Equation></Text-field><Text-field layout="Maple Output" style="2D Output"><Equation>NiM+SShncmFkblRURzYiLUknUlRBQkxFR0YlNiUiKU9LKT0jLUknTUFUUklYR0YlNiM3JDcjLCQqKiwmJCEiIiIiISIiIiokLUkldGFuaEc2JEkqcHJvdGVjdGVkR0Y6SShfc3lzbGliR0YlNiMsJiokLCYqJEkieEdGJSIiI0Y1KiRJInlHRiVGQkY1I0Y1RkIkIiYrPyJGNCQhIiRGNEY1RkJGNUY1LCYqJkkjVHhHRiVGNUZBRjUkIjAmUnUoUSIzLj0hIzoqJkkjVHlHRiVGNUZERjVGTUY1RkxGNUY/I0YzRkJGMzcjLCQqKkYxRjVGSkY1RlFGNUY/RlJGMyZJJ1ZlY3RvckdGOTYjSSdjb2x1bW5HRiU=</Equation></Text-field></Output></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">1/n_ref(x,y)*(grad_n(x,y)-gradnTT):
dT_ds:=simplify(convert(evalf(%),Vector),size);</Text-field></Input><Output><Text-field layout="Maple Output" style="2D Output"><Equation>NiM+SSZkVF9kc0c2Ii1JJ1JUQUJMRUdGJTYlIidXbk0tSSdNQVRSSVhHRiU2IzckNyMqLC1JI1BpR0kqcHJvdGVjdGVkR0YyNiRJInhHRiVJInlHRiUiIiIsJiQhIiIiIiFGNiokLUkldGFuaEc2JEYySShfc3lzbGliR0YlNiMsJiokLCYqJEY0IiIjRjYqJEY1RkVGNiNGNkZFJCImKz8iRjokISIkRjpGNkZFRjZGNiwoRjQkITAmUnUoUSIzLj0hIzoqJkkjVHhHRiVGRUY0RjYkIjAmUnUoUSIzLj1GTyooRlFGNkkjVHlHRiVGNkY1RjZGUkY2LChGMCRGNkY6JCEwM01ZLmMvcyUhIz5GNi1GPTYjLCZGQiQiMCsrKysrKz8iISM1JCEwKysrKysrKyQhIzlGNiQiMDNNWS5jL3MlRlpGOUZDI0Y5RkU3IyosRjBGNkY3RjYsKEY1Rk0qKEZVRjZGUUY2RjRGNkZSKiZGVUZFRjVGNkZSRjZGVkY5RkNGYG8mSSdWZWN0b3JHRj42I0knY29sdW1uR0Yl</Equation></Text-field></Output></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input"><Font encoding="ISO8859-1" foreground="[0,0,255]">				####	proc\351dure donnant la trajectoire d'un rayon</Font><Font foreground="[0,0,255]">
				####	calculant sa "pos" et son vecteur "dir" pour chaque pas dt</Font>
traj:=proc(xx0,yy0,Txx0,Tyy0,dtt,cc,NN)
local i;
global x0,y0,Tx0,Ty0,dt,c,pos,dir,intensite;
x0:=evalf(xx0);		y0:=evalf(yy0);
Tx0:=evalf(Txx0);	Ty0:=evalf(Tyy0);
dt:=evalf(dtt);		c:=evalf(cc);
intensite:=1;			<Font foreground="[0,51,255]">####	on va aussi calculer l'absorbtion</Font>
for i from 0 to NN do 
x||(i+1):= x||i + Tx||i * c/n_ref(x||i,y||i)*dt;
y||(i+1):= y||i + Ty||i * c/n_ref(x||i,y||i)*dt;
Tx||(i+1):=Tx||i + subs([x=x||i,y=y||i , Tx=Tx||i, Ty=Ty||i] , dT_ds[1] )*c/n_ref(x||i,y||i)*dt;
Ty||(i+1):=Ty||i + subs([x=x||i,y=y||i , Tx=Tx||i, Ty=Ty||i] , dT_ds[2] )*c/n_ref(x||i,y||i)*dt;
intensite:=intensite*exp(-n_abs(x||i,y||i) * 2 * 2*evalf(Pi)/lambda *c/n_ref(x||i,y||i)*dt);
od:
dir:=[seq([Tx||i,Ty||i],i=0..NN)]:	pos:=[seq([x||i,y||i],i=0..NN)]:	end:</Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">tt:=time():			<Font encoding="ISO8859-1" foreground="[0,0,255]">####	pour plein de rayons incidents \351quidistants</Font>
pos_aploter:=[]:dir_aploter:=[]:intense_finale:=[]:
				for i from 0 to 300 do
				traj(-5*Delta, i/60*Delta ,1,0,Delta/3e8/10,3e8,200);
	pos_aploter:=[op(pos_aploter),pos];
	dir_aploter:=[op(dir_aploter),dir];
	intense_finale:=[op(intense_finale),evalf(intensite)];
					od:
time()-tt;</Text-field></Input><Output><Text-field layout="Warning" style="Warning">Warning,  computation interrupted</Text-field><Text-field layout="Maple Output" style="2D Output"><Equation>NiMkIiV0RSEiJA==</Equation></Text-field></Output></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">plot(pos_aploter,color=red):
plots[display]([%,plottools[circle]([0,0],2*Delta,color=blue)],scaling=constrained);
plot(dir_aploter,color=red):
plots[display]([ % ,
plottools[arc]([0,0],1,	arcsin(min(op(map(x-&gt;x[2],(map(xx-&gt;xx[-1],dir_aploter))))))..	# un cercle
			arcsin(max(op(map(x-&gt;x[2],(map(xx-&gt;xx[-1],dir_aploter)))))),color=blue)]<Font encoding="ISO8859-1">
	,title="les directions doivent rester sur le cercle unit\351! (bleu)"</Font>);</Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input"><Font encoding="ISO8859-1" foreground="[0,0,255]">				####	on extrait les rayons apr\350s l'effet de "mirage"
				####	l\340 d'o\371 on croit qu'ils viennent</Font>
pos_final:=[seq(op([i,-1],pos_aploter),i=1..nops(pos_aploter))]:nops(%);
dir_final:=[seq(op([i,-1],dir_aploter),i=1..nops(pos_aploter))]:nops(%);

affine_final:=[seq(  op([i,-1,-1],dir_aploter)/op([i,-1,-2],dir_aploter) * (x-op([i,-1,-2],pos_aploter)) 
			+ op([i,-1,-1],pos_aploter)    
			,i=1..nops(pos_aploter))]:nops(%);</Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">plot(affine_final,x=-15*Delta..15*Delta,color=red):
plots[display]([%,plottools[circle]([0,0],2*Delta,color=blue)]
	,title="directions \"mirage\" des rayons");</Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input"><Font encoding="ISO8859-1" foreground="[0,0,255]">				####	-&gt; la densit\351 de rayon dans le plan objet d'abscisse "Xobj",
				####	dont on fait l'image grace \340 une lentille</Font>
dens:=xxobj-&gt;subs(x=xxobj,affine_final):	nops(dens(0));</Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input"><Font foreground="[0,0,255]">				####	on convole les rayons par une fonction d'apareil gaussienne :
				####	"<Font encoding="ISO8859-1">pixel_gauss" centr\351e en "yy" et de largeur "pix"</Font></Font>
pixel_gauss:=proc(yy,ppix)
exp(-(y-yy)^2/(ppix/2)^2);
end:</Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">detect_plus:= add(pixel_gauss( dens(planobj)[i],pix) * intense_finale[i] ,i=1..nops(dens(0))):
detect_moins:=0:
if op([1,1,2],pos_aploter)=0 then
detect_moins:=add(pixel_gauss(-dens(planobj)[i],pix) * intense_finale[i] ,i=2..nops(dens(0))):
fi:<Font encoding="ISO8859-1" foreground="[0,0,255]">
#  ATTENTION "plus" et "moins" seulement si on a consid\351r\351 que les x&gt;=0, et qu'on sym\351trise ...</Font>
nops(detect_plus);
en0:=subs(y=0,detect_plus+detect_moins):
en_bord:=subs(y=4*Delta,detect_plus+detect_moins):</Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">plot(subs(	[pix= 8e-6,planobj=0]	,(detect_plus+detect_moins)/en_bord)
		,y=-6*Delta..6*Delta,numpoints=500<Font encoding="ISO8859-1">
	,title="CCD d\351tection \134n en bleu : les atomes"):</Font>
plots[display]([%,plot(n_at(x,0),x=-6*Delta..6*Delta,color=blue)]);</Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">plots[animate](plot,[subs(	[pix= 8e-6]	,(detect_plus+detect_moins)/en_bord)
		,y=-6*Delta..6*Delta]	,	planobj=-500*Delta..500*Delta):
plots[display]([%,plot(n_at(x,0),x=-6*Delta..6*Delta,color=blue)]);</Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input"/></Input></Group><Text-field/><Text-field/><Text-field/><Text-field/><Text-field/><RTable handle="32836376" >TTdSMApJNVJUQUJMRV9TQVZFLzMyODM2Mzc2WColKWFueXRoaW5nRzYiNiJbZ2whIyUhISEiIyIjLCQqKCwmJCEiIiIiISIiIiokLSUldGFuaEc2CiMsJiokLCYqJCUieEciIiNGLSokJSJ5R0Y3Ri0jRi1GNyQiJis/IkYsJCEiJEYsRi1GN0YtRi1GNkYtRjQjRitGNyQhMCZSdShRIjMuPSEKIzosJCooRilGLUY5Ri1GNEY/RkBGJgo=</RTable><RTable handle="31559924" >TTdSMApJNVJUQUJMRV9TQVZFLzMxNTU5OTI0WColKWFueXRoaW5nRzYiNiJbZ2whIyUhISEiIyIjLCQqKiwmJCEiIiIiISIiIiokLSUldGFuaEc2CiMsJiomIiM4I0YtIiIjKiQlKmRlbWlsYXJnZUdGNkY1JCImKz8iRiwkISIkRixGLUY2Ri1GLUY4Ri1GNEY1RjcjRitGNiQiMCMqZmRPclIKeCMhIzssJEYoJCEwKilSJ1txJjQ7JUZARiYK</RTable><RTable handle="31560204" >TTdSMApJNVJUQUJMRV9TQVZFLzMxNTYwMjA0WColKWFueXRoaW5nRzYiNiJbZ2whIyUhISEiIyIjJSNUeEclI1R5R0YmCg==</RTable><RTable handle="21883236" >TTdSMApJNVJUQUJMRV9TQVZFLzIxODgzMjM2WColKWFueXRoaW5nRzYiNiJbZ2whIyUhISEiIyIjLCQqKiwmJCEiIiIiISIiIiokLSUldGFuaEc2CiMsJiokLCYqJCUieEciIiNGLSokJSJ5R0Y3Ri0jRi1GNyQiJis/IkYsJCEiJEYsRi1GN0YtRi0sJiomJSNUeEdGLUY2Ri0kIjAmUnUoUSIKMy49ISM6KiYlI1R5R0YtRjlGLUZCRi1GQUYtRjQjRitGN0YrLCQqKkYpRi1GP0YtRkZGLUY0RkdGK0YmCg==</RTable><RTable handle="346744" >TTdSMApJM1JUQUJMRV9TQVZFLzM0Njc0NFgqJSlhbnl0aGluZ0c2IjYiW2dsISMlISEhIiMiIyosLSUjUGlHNiQlInhHJSJ5RyIiIiwmJCEiIiIiCiFGLSokLSUldGFuaEc2IywmKiQsJiokRisiIiNGLSokRixGOkYtI0YtRjokIiYrPyJGMSQhIiRGMUYtRjpGLUYtLChGKyQhMCZSdShRIjMKLj0hIzoqJiUjVHhHRjpGK0YtJCIwJlJ1KFEiMy49RkQqKEZGRi0lI1R5R0YtRixGLUZHRi0sKEYoJEYtRjEkITAzTVkuYy9zJSEjPkYtLQpGNDYjLCZGNyQiMCsrKysrKz8iISM1JCEwKysrKysrKyQhIzlGLSQiMDNNWS5jL3MlRk9GMEY4I0YwRjoqLEYoRi1GLkYtLChGLEZCKihGCkpGLUZGRi1GK0YtRkcqJkZKRjpGLEYtRkdGLUZLRjBGOEZlbkYmCg==</RTable></Worksheet>